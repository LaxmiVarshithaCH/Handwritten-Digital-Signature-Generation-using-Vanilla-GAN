# Handwritten Signature Generation and Verification using Vanilla GAN

This project implements an end-to-end pipeline for offline handwritten signature generation and verification using **Vanilla Generative Adversarial Networks (GANs)** and a **Siamese Convolutional Neural Network (CNN)**.  
Synthetic signatures generated by GANs are used to augment scarce genuine signature data and improve verification robustness on the CEDAR Offline Signature Dataset.

---

## ğŸ“Œ Project Introduction

Offline handwritten signatures are still widely used in banks, universities, e-governance systems, and legal institutions for identity verification. However, practical signature verification systems suffer from:

- Limited genuine samples per user  
- Scarcity of skilled forgeries  
- High intra-personal variation in handwriting  

Conventional data augmentation techniques fail to capture realistic stroke-level variations.  
This project explores the use of a **Vanilla GAN** to learn the distribution of handwritten signatures and generate **realistic synthetic samples**, which are then used to augment training data for a **signature verification model**.

---

## ğŸ¯ Key Features

- **Generic Vanilla GAN** trained on genuine signatures from multiple users  
- **User-specific Vanilla GANs** fine-tuned per signer to capture intra-personal variation  
- **Siamese CNNâ€“based signature verification model**  
- **GAN-based data augmentation** for verification training  
- **CEDAR dataset preparation scripts** (raw â†’ structured format)  
- **Streamlit UI** for interactive signature generation  
- **FastAPI service** returning a ZIP of generated signatures  
- **Evaluation framework** reporting FAR, FRR, and EER  

---

## ğŸ§­ System Overview

- **Dataset:** CEDAR Offline Handwritten Signature Dataset  
- **Generative Model:** Vanilla GAN (Generator + Discriminator)  
- **Training Modes:** Generic GAN and User-Specific GANs  
- **Verification Model:** Siamese CNN  
- **Evaluation Metrics:** FAR, FRR, EER  
- **Deployment:** CLI tools, Streamlit UI, FastAPI API  

---

## ğŸ“ Project Structure

```text
project2/
â”œâ”€â”€ data/
â”‚   â””â”€â”€ cedar/
â”‚       â”œâ”€â”€ genuine/            # Genuine signatures per user
â”‚       â””â”€â”€ forgery/            # Skilled forgeries per user
â”œâ”€â”€ generated/
â”‚   â””â”€â”€ generic/                # Generated signatures (generic GAN)
â”œâ”€â”€ checkpoints/
â”‚   â”œâ”€â”€ generic/                # Generic GAN & verifier checkpoints
â”‚   â””â”€â”€ user_specific/          # User-specific GAN generators
â”œâ”€â”€ samples/                    # Training sample grids
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ prepare_cedar.py
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api.py
â”‚   â”œâ”€â”€ app.py
â”‚   â”œâ”€â”€ preprocess_signatures.py
â”‚   â”œâ”€â”€ data_loader_signatures.py
â”‚   â”œâ”€â”€ generator_vanilla_gan.py
â”‚   â”œâ”€â”€ discriminator_vanilla_gan.py
â”‚   â”œâ”€â”€ vanilla_gan_model.py
â”‚   â”œâ”€â”€ train_gan_generic.py
â”‚   â”œâ”€â”€ train_gan_user_specific.py
â”‚   â”œâ”€â”€ generate_signatures.py
â”‚   â”œâ”€â”€ siamese_model.py
â”‚   â”œâ”€â”€ signature_pairs_dataset.py
â”‚   â”œâ”€â”€ signature_verifier_train.py
â”‚   â”œâ”€â”€ signature_verifier_eval.py
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ metrics.py
â”‚       â””â”€â”€ visualizer.py
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```
**Note:** Large datasets, checkpoints, and generated samples are excluded via ```.gitignore```.

---

## ğŸ—ï¸ Architecture Flow

```mermaid
flowchart TD
    A[CEDAR Dataset] --> B[Preprocessing]
    B --> C[Vanilla GAN Training]
    C --> D[Generator]
    C --> E[Discriminator]
    D --> F[Synthetic Signatures]
    F --> G[Verification Training]
    G --> H[Siamese CNN]
    H --> I[FAR / FRR / EER]
    D --> J[CLI Generator]
    D --> K[Streamlit UI]
    D --> L[FastAPI Service]
```

---

## ğŸ§© Modules & Design
### 1) Data Pipeline & Preprocessing
Dataset: **CEDAR Offline Signature Dataset**
- Images are grayscale and resized to **64Ã—64**
- Pixel values normalized to **[âˆ’1, 1]** for ```tanh``` compatibility
- Hard binarization and heavy morphological operations are avoided to preserve stroke continuity
Dataset preparation:
```bash
python scripts/prepare_cedar.py
```
Creates:
```bash
data/cedar/genuine/<user_id>/*.png
data/cedar/forgery/<user_id>/*.png
```

### 2) Vanilla GAN Architecture
**Generator**
- Input: latent vector, z âˆˆ R 100
- Linear projection â†’ reshape
- ConvTranspose layers with BatchNorm + ReLU
- Architecture:
```text
  [z (100)]
  â””â”€ Linear(100 â†’ 512Ã—8Ã—8) + BatchNorm + ReLU
      â””â”€ Unflatten â†’ (512, 8, 8)
          â””â”€ ConvTranspose2d(512 â†’ 256, k=4, s=2, p=1) + BatchNorm2d + ReLU
              â””â”€ Output: (256, 16, 16)
                  â””â”€ ConvTranspose2d(256 â†’ 128, k=4, s=2, p=1) + BatchNorm2d + ReLU
                      â””â”€ Output: (128, 32, 32)
                          â””â”€ ConvTranspose2d(128 â†’ 1, k=4, s=2, p=1) + Tanh
                              â””â”€ Output: (1, 64, 64)
```
- Output: **64Ã—64Ã—1** grayscale image
- Final activation: ```tanh```

**Discriminator**
- Input: **64Ã—64Ã—1** image
- Convolutional layers with stride-based downsampling
- LeakyReLU activations
- Architecture:
```text
Input Image: (1, 64, 64)
  â””â”€ Conv2d(1 â†’ 128, k=4, s=2, p=1) + LeakyReLU(0.2)
      â””â”€ Output: (128, 32, 32)
          â””â”€ Conv2d(128 â†’ 256, k=4, s=2, p=1) + BatchNorm2d + LeakyReLU(0.2)
              â””â”€ Output: (256, 16, 16)
                  â””â”€ Conv2d(256 â†’ 512, k=4, s=2, p=1) + BatchNorm2d + LeakyReLU(0.2)
                      â””â”€ Output: (512, 8, 8)
                          â””â”€ Flatten â†’ Linear(512Ã—8Ã—8 â†’ 1) + Sigmoid
                              â””â”€ Output: P(real)
```
- Sigmoid output for real/fake classification

#### Training details
- Loss: Binary Cross-Entropy (BCE) for both Generator and Discriminator
- Optimizer: Adam optimizers (generic: ```lr=2e-4```, ```betas=(0.5, 0.999```); userâ€‘specific fineâ€‘tuning uses smaller lr).
- Stabilization: Label smoothing (real = 0.9), controlled update schedule

### 3) Training Pipeline
**Generic GAN**
- Trained on genuine signatures from multiple users
- Learns global handwriting characteristics
- Used for generic data augmentation
```bash
python src/train_gan_generic.py
```
**Artifacts:**
- Samples: ```samples/generic/```
- Generator: ```checkpoints/generic/generator.pth```

<p align="center">
  <img src="https://github.com/user-attachments/assets/1eafefd6-1fdc-4225-8f28-69bcabda36db" width="530" height="68" alt="epoch_300"/>
  <br>
  <em>Sample at epoch 300</em>
</p>

**User-Specific GAN**
- One GAN per user
- Initialized from generic generator
- Fine-tuned with smaller batch size and learning rate
- Captures intra-personal signature variation
```bash
python src/train_gan_user_specific.py
```
**Artifacts:**
- Samples: ```samples/user_specific/```
- Generators: ```checkpoints/user_specific/user_XX.pth```

<p align="center">
  <img src="https://github.com/user-attachments/assets/58fdbd76-6a63-4bf8-8734-00c0e9f4e32e" width="530" height="68" alt="epoch_300"/>
  <br>
  <em>Sample at User_01 epoch 150</em>
</p>

### 4) Signature Verification Model
- **Siamese CNN** implemented in ```siamese_model.py```
- Learns a similarity score between two signatures
- Loss: Binary Cross-Entropy
**Pair Construction:**
- Genuineâ€“Genuine â†’ label 1
- Genuineâ€“Forgery â†’ label 0
- Genuineâ€“GAN â†’ label 1 (augmentation)
  
Training:
```bash
python src/signature_verifier_train.py
```
**Baseline mode (```usegan=False``` in code):**
- Pairs only real genuine and real forgery signatures.â€‹
- Trains for 10 epochs and saves ```checkpoints/siamese_baseline.pth```.

  â€‹
**GANâ€‘augmented mode (```usegan=True``` in code):**
- Adds genuineâ€“GAN pairs using signatures from ```generated/generic/``` (or other GAN output).â€‹
- Trains a second model and saves ```checkpoints/siamese_augmented.pth```.â€‹

### 5) Evaluation & Performance Assessment
Metrics:
- **False Acceptance Rate (FAR)**
- **False Rejection Rate (FRR)**
- **Equal Error Rate (EER)**
  
Evaluation:
```bash
python src/signature_verifier_eval.py
```
- Uses SignaturePairsDataset(data/cedar) and loads a chosen checkpoint.â€‹
- Computes FAR, FRR, and EER via ```utils/metrics.py``` (ROC curveâ€“based computation).
  
**Results Summary**
| Model          | FAR â†“ | FRR  | EER â†“  |
|----------------|-------|------|--------|
| Baseline       | 0.022 | 0.344 | 0.024  |
| GAN-Augmented  | 0.013 | higher | 0.00076 |

**Interpretation:**
GAN-based augmentation significantly reduces **EER and FAR**, improving verification robustness when genuine samples are scarce. FRR increase reflects a threshold-dependent trade-off.

### 6) Inference & Tools
**Command-Line Generation**
```bash
python src/generate_signatures.py
```

**Streamlit UI**
```bash
streamlit run src/app.py
```
- Choose Generic or User-Specific GAN
- Select number of signatures (1â€“50)
- Preview generated outputs

<p align="center">
  <img src="https://github.com/user-attachments/assets/44d7d874-e650-4bdf-ab15-f2580355c7e6" width="2940" height="1912" alt="Generic-generated signatures"/>
  <br>
  <em>Streamlit UI - Generic Generated Signatures</em>
</p>

<p align="center">
  <img src="https://github.com/user-attachments/assets/4dc44af9-019d-4b75-a8c6-12e826adc218" width="530" height="332" alt="UI output"/>
  <br>
  <em>UI output - Generated Signatures</em>
</p>

**FastAPI Service**
```bash
uvicorn src.api:app --reload
```

**POST /generate**
```bash
{
  "n": 10,
  "user_id": "user_01" // optional; generic model used if omitted
}
```
Returns a streaming ZIP of generated signature images.

---

## âš™ï¸ Setup & Installation
```bash
python -m venv .venv
source .venv/bin/activate     #for macos/linux
.venv\Scripts\activate        #for windows(cmd)
pip install -r requirements.txt
```

---

## ğŸ§ª Experiments & Findings
- Initial experiments on a non-CEDAR dataset produced noisy and fragmented signatures
- CEDAR-based training yielded cleaner strokes and realistic samples
- User-specific GANs produced higher-quality signatures than generic GANs
- GAN augmentation stabilized Siamese training but introduced FAR/FRR trade-offs dependent on threshold selection

---

## âš ï¸ Limitations
- Uses a basic Vanilla GAN (no DCGAN / WGAN-GP / diffusion models)
- Limited resolution (64Ã—64â€“128Ã—128)
- Synthetic samples treated as genuine without explicit forgery modeling
- Offline signatures only (no dynamic stroke information)

---

## ğŸš€ Future Work
- Conditional GANs (CGAN / ACGAN)
- Higher-resolution signatures (256Ã—256)
- Advanced GAN architectures (DCGAN, StyleGAN)
- Improved verification calibration and operating-point selection
- Online signature modeling

---

## ğŸ‘¥ Team

<table>
  <tr>
      <td align="center">
      <a href="https://github.com/ishitachowdary">
        <img src="https://avatars.githubusercontent.com/ishitachowdary" width="100px;" alt=""/>
        <br />
        <sub><b>Ishitha Chowdary</b></sub>
      </a>
      <br />
    </td>
    <td align="center">
      <a href="https://github.com/LaxmiVarshithaCH">
        <img src="https://avatars.githubusercontent.com/LaxmiVarshithaCH" width="100px;" alt=""/>
        <br />
        <sub><b>Chennupalli Laxmi Varshitha</b></sub>
      </a>
      <br />
    </td>
    <td align="center">
      <a href="https://github.com/Jhansi652">
        <img src="https://avatars.githubusercontent.com/Jhansi652" width="100px;" alt=""/>
        <br />
        <sub><b>Y. Jhansi</b></sub>
      </a>
      <br />
    </td>
      <td align="center">
      <a href="https://github.com/2300033338">
        <img src="https://avatars.githubusercontent.com/2300033338" width="100px;" alt=""/>
        <br />
        <sub><b>V. Swarna Blessy</b></sub>
      </a>
      <br />
    </td>
      <td align="center">
      <a href="https://github.com/2300030435">
        <img src="https://avatars.githubusercontent.com/2300030435" width="100px;" alt=""/>
        <br />
        <sub><b>MD. Muskan</b></sub>
      </a>
      <br />
    </td>
      <td align="center">
      <a href="https://github.com/likhil2300030419">
        <img src="https://avatars.githubusercontent.com/likhil2300030419" width="100px;" alt=""/>
        <br />
        <sub><b>Likhil Sir Sai</b></sub>
      </a>
      <br />
    </td>
  </tr>
</table>

---

## ğŸ“¬ Feedback
- Suggestions and improvements are welcome.
- Feel free to open an issue or submit a pull request.
- **Happy coding! ğŸš€**
